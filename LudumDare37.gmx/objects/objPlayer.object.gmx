<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>sprPlayerFront</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>walkSpeed = 2
width = 24
height = 24
halfWidth = width/2
halfHeight = height/2

numSeedsPerRound = 4
numSeeds = numSeedsPerRound

ableToCancel = false

tileX = 0
tileY = 0
tileXWorld = 0
tileYWorld = 0
uiAnimT = 0

image_speed = 0
CanDisplay = 0
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// movement

var xLast = x
var yLast = y

var left = keyboard_check(vk_left)
var right = keyboard_check(vk_right)
var up = keyboard_check(vk_up)
var down = keyboard_check(vk_down)

if left {
    x -= walkSpeed
}
else if right {
    x += walkSpeed
}

if up {
    y -= walkSpeed
}
else if down {
    y += walkSpeed
}

if y &lt; yLast {
    sprite_index = sprPlayerBack
}
else if y &gt; yLast {
    sprite_index = sprPlayerFront
}
else if x &lt; xLast {
    sprite_index = sprPlayerLeft
}
else if x &gt; xLast {
    sprite_index = sprPlayerRight
}

// out of bounds push back in
while x - halfWidth &lt; objHouse.bbox_left {
    x += 1
}

while x + halfWidth - 1 &gt; objHouse.bbox_right {
    x -= 1
}

while y - halfHeight &lt; objHouse.bbox_top {
    y += 1
}

while y + halfHeight - 1 &gt; objHouse.bbox_bottom {
    y -= 1
}

if x != xLast or y != yLast {
    // coming out of standstill
    if image_speed == 0 {
        image_index = 1
    }
    image_speed = 1/10
}
else {
    image_speed = 0
    image_index = 0
}
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// place seeds and stuff

ableToCancel = false

// Calculate the player's tile
tileX = floor((x-objHouse.x) / global.tileSize)
tileY = floor((y-objHouse.y) / global.tileSize)
tileXWorld = objHouse.x + tileX*global.tileSize
tileYWorld = objHouse.y + tileY*global.tileSize

if objPlanter.state == PlantState_Plant {
    // Plant vine
    placeable = scrTileIsValidPlant(tileX, tileY)
    if placeable and keyboard_check_pressed(ord('Z')) {
        var vb = instance_create(tileXWorld+16, tileYWorld+16, objVineBase)
        objPlanter.objectGrid[# tileX, tileY] = vb
        objPlanter.state = PlantState_Choose
    }
}
else if objPlanter.state == PlantState_Choose {
    // Choose vine
    vineChoice = scrTileIsValidChoose(tileX, tileY)
    placeable = instance_exists(vineChoice)
    if placeable and keyboard_check_pressed(ord('Z')) {
        // Create first seed
        objPlanter.state = PlantState_Draw
        ds_list_add(objPlanter.pathListX, vineChoice.tileX)
        ds_list_add(objPlanter.pathListY, vineChoice.tileY)
        
        // Create cancel object
        var cancelTileX = 4
        var cancelTileY = 4
        var topleft = (y-objHouse.x) &lt; -(x-objHouse.x) + (objHouse.bbox_left+objHouse.bbox_right)/2
        var botleft = (y-objHouse.x) &gt; (x-objHouse.x)
        var offset = 2
        if topleft and botleft {
            cancelTileX +=offset
        }
        else if not topleft and not botleft {
            cancelTileX -= offset
        }
        else if topleft and not botleft {
            cancelTileY += offset
        }
        else if not topleft and botleft {
            cancelTileY -= offset
        }
        var cancel = instance_create(objHouse.x+global.tileSize*cancelTileX,
        objHouse.y+global.tileSize*cancelTileY, objCancelDraw)
        
        objPlanter.objectGrid[# cancelTileX, cancelTileY] = cancel
    }
}

if objPlanter.state == PlantState_Draw {
    // Extend the path
    placeable = scrTileIsValidPath(tileX, tileY) and numSeeds &gt; 0
    if placeable and keyboard_check_pressed(ord('Z')) {
        var s = instance_create(tileXWorld, tileYWorld, objSeed)
        objPlanter.objectGrid[# tileX, tileY] = s
        
        ds_list_add(objPlanter.pathListX, tileX)
        ds_list_add(objPlanter.pathListY, tileY)
        
        numSeeds -= 1
        CanDisplay = 1
        
        if numSeeds == 0 {
            scrGrowVine()
        }
    }
    
    // Check if on top of cancel object
    var objAtTile = objPlanter.objectGrid[# tileX, tileY]
    if instance_exists(objAtTile) and objAtTile.object_index == objCancelDraw {
        ableToCancel = true
        objCancelDraw.image_index = 1
        if keyboard_check_pressed(ord('Z')) {
            scrClearPath()
        }
    }
    else with objCancelDraw image_index = 0
}

uiAnimT += 1
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// destroy vines

var foundCloseVine = false

with objVineBase {
    if point_distance(x, y, objPlayer.x, objPlayer.y) &lt; 50
    and ds_list_size(segmentList) &gt; 1 {
        destroyVisible = true
        if not foundCloseVine and keyboard_check_pressed(ord('X')) {
            for (var i=0; i&lt;ds_list_size(segmentList); i+=1) {
                with segmentList[| i] {
                    instance_destroy()
                }
            }
            with bulbObj instance_destroy()
            instance_destroy()
            objPlanter.objectGrid[# tileX, tileY] = noone
            objPlanter.state = PlantState_Plant
        }
        foundCloseVine = true
    }
    else {
        destroyVisible = false
    }
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="73">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>// Draw square highlight
if placeable {
    var rectOff = 0
    var arrowOff = 0
    if floor(uiAnimT/20) mod 2 != 0 {
        rectOff = 1
        arrowOff = 1
    }
    
    draw_set_color(c_white)
    draw_rectangle(tileXWorld-rectOff, tileYWorld-rectOff,
        tileXWorld+global.tileSize-1+rectOff, tileYWorld+global.tileSize-1+rectOff, true)
    draw_sprite(sprArrowDown, 0, tileXWorld+global.tileSize/2, tileYWorld+4-arrowOff)
}
else if not ableToCancel {
    draw_sprite_ext(sprNoSelectSquare, 0, tileXWorld, tileYWorld, 1, 1, 0, c_white, 1)
}

// Draw num seeds

/*
draw_set_color(c_white)
draw_set_halign(fa_left)
draw_set_valign(fa_top)
draw_text(x-10, y-38, 'x'+string(numSeeds))
*/
if CanDisplay = 1 draw_sprite(sprWateringCan,abs(numSeeds-4),x,y-53)
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>draw_sprite_ext(sprite_index, image_index, x, y-12, image_xscale, image_yscale, image_angle, image_blend, image_alpha)
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
